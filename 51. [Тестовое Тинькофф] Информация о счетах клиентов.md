# [Тестовое Тинькофф] Информация о счетах клиентов

## Задание
Вы работаете с таблицей ```account_statuses```, которая содержит три столбца (```date```, ```customer_id```, ```account_status```).

Величина ```acount_status``` может принимать следующие значения:

- новый
- активирован
- утилизирован
- заблокирован
- закрыт

Необходимо написать sql-запрос, в котором будет посчитано кол-во клиентов, сгруппированных по месяцам, с рабочим счетом (новый, активирован, утилизирован), и с нерабочим счетом (заблокирован, закрыт).

## Столбцы в результате

- ```month```
- ```working```
- ```non_working```

**Примечание:** для корректной работы вашего запроса обязательно указывайте схему таблиц - ```tinkoff```. Например, ```FROM tinkoff.employees```.

## Решение
``` SQL
SELECT 
  EXTRACT(
    MONTH 
    FROM 
      date
  ) AS month, 
  COUNT(
    CASE WHEN acount_status IN (
      'новый', 'активирован', 
      'утилизирован'
    ) THEN 1 END
  ) AS working, 
  COUNT(
    CASE WHEN acount_status IN (
      'заблокирован', 'закрыт'
    ) THEN 1 END
  ) AS non_working 
FROM 
  tinkoff.account_statuses a
GROUP BY 
  EXTRACT(
    MONTH 
    FROM 
      date
  )
```