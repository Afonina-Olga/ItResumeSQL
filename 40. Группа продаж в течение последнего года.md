# Группа продаж в течение последнего года

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database1.png "Схема БД")

## Задание
Выведите следующую информацию:

- ID анализа
- количество продаж каждого анализа в штуках с ```01.03.2019``` по ```01.03.2020``` (включительно обе даты)
- группа продаж по количеству продаж каждого анализа

Правила формирования групп анализа:

- если количество продаж анализа строго больше 20, то группа 2
- если количество продаж анализа больше 10 (не включительно) и меньше или равно 20, то группа 1
- если меньше 10 (включительно), то группа 0

## Столбцы в результате
- ```an_id``` - идентификатор анализа
- ```amount``` - количество продаж каждого анализа
- ```gr``` - группа продаж по количеству продаж каждого анализа

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат отсортируйте по возрастанию поля ```an_id```.

## Решение
``` SQL
SELECT 
  ord_an AS an_id, 
  COUNT(*) AS amount, 
  CASE WHEN COUNT(*) > 20 THEN 2 WHEN COUNT(*) > 10 
  OR COUNT(*) <= 20 THEN 1 ELSE 0 END AS gr 
FROM 
  orders o 
WHERE 
  ord_datetime BETWEEN '2019-03-01' 
  AND '2020-03-01' 
GROUP BY 
  ord_an 
ORDER BY 
  an_id
```