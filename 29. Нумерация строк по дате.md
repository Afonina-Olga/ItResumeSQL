# Нумерация строк по дате

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database1.png "Схема БД")

## Задание
В рамках каждого дня пронумеруйте строки, опираясь на дату и время заказа (по убыванию). Для каждого нового дня нумерация должна начинаться заново.

## Столбцы в результате
- ```dt``` - только дата
- ```ord_datetime``` - дата и время заказа
- ```ord_id``` - номер заказа
- ```ord_an``` - ID анализа
- ```rn``` - порядковый номер строки

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат необходимо отсортировать по возрастанию ```dt```, ```ord_datetime```.

## Решение
``` SQL
SELECT 
  ord_datetime :: DATE AS dt, 
  ord_datetime, 
  ord_id, 
  ord_an, 
  ROW_NUMBER() OVER (
    PARTITION BY ord_datetime :: DATE 
    ORDER BY 
      ord_datetime DESC
  ) rn 
FROM 
  Orders
```