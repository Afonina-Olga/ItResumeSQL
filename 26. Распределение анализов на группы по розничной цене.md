# Распределение анализов на группы по розничной цене

## Дано
Таблица ```assay```:

```
+---------------------------------------------------------+
|   assay                                              |
+---------------------------------------------------------+
|   id_an - идентификатор анализа (PK)                    |
|   name - название анализа                               |
|   id_type - тип анализа                                 |
|   preanalysis - требуется ли специальная преаналитика   |
|   id_cat_an - идентификатор категории                   |
|   cost_price - закупочная цена                          |
|   selling_price - розничная цена                        |
|   term - температурный режим                            |
|   info - дополнительная информация                      |
+---------------------------------------------------------+
```

## Задание
Необходимо разделить анализы на группы по розничной цене.

**Правило разделения на группы:** 1 — самые дорогие анализы по розничной цене, 4 — самые дешевые анализы по розничной цене.

**Примечание:** для решения задания используйте функцию ```NTILE```.

## Выводимые столбцы

- ```id_an``` - идентификатор анализа
- ```name``` - название анализа
- ```selling_price``` - розничная цена анализа
- ```selling_price_quartile``` - группа анализа по розничной цене

**Важно:** обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Порядок сортировки по возрастанию ```id_an```.

## Решение
``` SQL
SELECT 
  id_an, 
  name, 
  selling_price, 
  NTILE(4) OVER (
    ORDER BY 
      selling_price DESC
  ) selling_price_quartile 
FROM 
  assay 
ORDER BY 
  id_an 
```