# Округлить и отфильтровать наценку

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database12.png)

## Задание
Округлите наценку на каждую позицию из таблицы ```Заказов``` до ближайшего десятка. Выберите только те строки, где наценка больше ```50%```.

**Примечание.** Наценка рассчитывается по формуле ```Наценка = (Розница - Себестоимость)/Себестоимость```

##Столбцы в результате

- ```ord_id```
- ```ord_datetime```
- ```ord_an```
- ```markup``` - рассчитанная наценка

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка

Дополнительных условий по сортировке нет. Строки выводятся по мере расположения в исходной таблице.

## Решение

``` SQL
SELECT 
  ord_id, 
  ord_datetime, 
  ord_an, 
  ROUND(
    100 * (an_price - an_cost):: NUMERIC / an_cost, 
    -1
  ) AS markup 
FROM 
  Orders o 
  JOIN Analysis a ON o.ord_an = a.an_id 
WHERE 
  ROUND(
    100 * (an_price - an_cost):: NUMERIC / an_cost, 
    -1
  ) > 50
```