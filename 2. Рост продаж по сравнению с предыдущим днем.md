# Рост продаж по сравнению с предыдущим днем

## **Дано**
Дана таблица sales:

```
+-----------+----------+-----------+
|    id     |   date   |   value   |
+-----------+----------+-----------+
```

## **Задание**

Необходимо вывести информацию о продажах за те даты, когда продажи были больше, чем за предыдущий день из таблицы ```sales```.

## **Столбцы в результате**

- ```date``` - ID анализа
- ```value``` - сумма за данный день
- ```lg``` - сумма за прошлый день

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## **Сортировка**

Результат необходимо отсортировать по возрастанию ```date```.

## **Решение**

``` SQL
WITH grouping AS
  (SELECT date, SUM(value) AS value
   FROM sales
   GROUP BY date), lag AS
  (SELECT date, value,
                COALESCE(LAG(value) OVER(
                                         ORDER BY date), 0) AS lg
   FROM grouping)
SELECT *
FROM lag
WHERE value > lg
ORDER BY date
```
