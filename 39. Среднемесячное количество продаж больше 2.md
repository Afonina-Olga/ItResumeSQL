# Среднемесячное количество продаж больше 2

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database1.png "Схема БД")

## Задание
Вывести ID анализов, у которых среднемесячное количество заказов больше 2 в 2020 году.

**Примечание.** Рассчитанное количество заказов округлите до 3 знака после запятой.

## Столбцы в результате
- ```an_id```
- ```cnt``` - среднемесячное кол-во заказов

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат отсортируйте по убыванию поля ```cnt```. Если поле cnt имеет одинаковое значение для нескольких строк, сортируйте ответ по возрастанию поля ```an_id```.

## Решение
``` SQL
SELECT 
  ord_an AS an_id, 
  ROUND(
    COUNT(*):: NUMERIC / 12, 
    3
  ) AS cnt 
FROM 
  Orders 
WHERE 
  EXTRACT(
    YEAR 
    FROM 
      ord_datetime
  ) = 2020 
GROUP BY 
  ord_an 
ORDER BY 
  cnt DESC, 
  an_id
```