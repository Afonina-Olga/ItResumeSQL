# [Тестовое Тинькофф] Процент дозвона

## Дано
Дана следующая структура таблиц:

![Схема базы](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database6.png)

## Задание
Вывести %% дозвона для каждого дня (%% дозвона – это доля принятых звонков (dozv_flg = 1) от всех поступивших звонков (dozv_flg = 1 or dozv_flg = 0)), период с 01.10.2020 по текущий день.

## Столбцы в результате

- ```date```
- ```sla``` (%% дозвона)

**Примечание:** для корректной работы вашего запроса обязательно указывайте схему таблиц - ```tinkoff```. Например, ```FROM tinkoff.employees```.

## Решение
``` SQL
SELECT 
  start_dttm AS date, 
  SUM(
    CASE WHEN dozv_flg = 1 THEN 1 ELSE 0 END
  ) / COUNT(dozv_flg):: NUMERIC AS sla 
FROM 
  tinkoff.Calls 
WHERE 
  start_dttm >= '2020-10-01' 
GROUP BY 
  start_dttm

```