# Сделать из «длинной» таблицы «широкую»

## Дано
Даны две таблицы ```LongTable``` и ```WideTable```:

```LongTable```:

```
+---------+--------+-----------------------+
|  Name   |   key  |        value          |
+---------+--------+-----------------------+
| Ivanov  |   FIO  |  Иванов Иван Иванович |
+---------+--------+-----------------------+
| Ivanov  | Phone  |  +(7) 111-1111111     |
+---------+--------+-----------------------+
| Ivanov  | Email  | ivanov@ivanov.com     |
+---------+--------+-----------------------+
| Petrov  |   FIO  | Петров Петр Петрович  |
+---------+--------+-----------------------+
| Petrov  | Phone  |  +(7) 222-2222222     |
+---------+--------+-----------------------+
| Petrov  | Email  | petrov@petrov.com     |
+---------+--------+-----------------------+
```

```WideTable```:

```
+---------+----------------------+------------------+-------------------+
|   Name  |         FIO          |      Phone       |       Email       |
+---------+----------------------+------------------+-------------------+
| Ivanov  | Иванов Иван Иванович | +(7) 111-1111111 | ivanov@ivanov.com |
+---------+----------------------+------------------+-------------------+
| Petrov  | Петров Петр Петрович | +(7) 222-2222222 | petrov@petrov.com |
+---------+----------------------+------------------+-------------------+
```

## Задание
Как из таблицы ```LongTable``` получить ```WideTable```?

**Примечание.** Предполагается чтение таблицы один раз и отсутствие соединений.

## Столбцы в результате
- ```Name```
- ```fio```
- ```phone```
- ```email```

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат отсортируйте по возрастанию поля Name.

## Решение
``` SQL
SELECT 
  name, 
  MAX(CASE WHEN key = 'FIO' THEN value END) AS FIO, 
  MAX(
    CASE WHEN key = 'Phone' THEN value END
  ) AS Phone, 
  MAX(
    CASE WHEN key = 'Email' THEN value END
  ) AS Email 
FROM 
  LongTable 
GROUP BY 
  name 
ORDER by 
  name
```