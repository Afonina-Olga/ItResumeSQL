# [Тестовое OZON] Количество людей из Москвы, купивших телефоны в сентябре и октябре

```Эта задача взята из тестового задания на позицию стажер-аналитик в Ozon```

## Дано
Дана следующая схема таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database43.png)

## Задание
Требуется вывести уникальное количество людей из города (```city```) ```“Москва”```, которые купили category ```“Телефон”``` в сентябре и октябре.

**Примечания:**

- месяц должен быть представлен в виде извлеченной из даты строки на английском языке.
- предполагается, что рассматриваемые данные относятся к одному календарному году.

## Выводимые столбцы
- ```month``` - полное название месяца на английском языке с большой буквы
- ```cnt_people``` - количество людей

**Важно:** обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
в порядке убывания количества людей.

## Дополнительные условия
Для корректной работы вашего запроса обязательно указывайте схему таблиц - ```ozon```. Например, ```FROM ozon.users```.

Обратите внимание, что при использовании функции ```TO_CHAR(..., 'Month')``` ```PostgreSQL``` дополняет название месяца пробелами до 9 символов, чтобы удалить пробелы используйте функцию ```TRIM```.

## Решение
``` SQL
SELECT
  TRIM(TO_CHAR(p.created_at, 'Month')) AS month,
  COUNT(DISTINCT user_id) AS cnt_people
FROM 
  ozon.purchases p 
  JOIN ozon.users u ON p.user_id = u.id 
  JOIN ozon.skus s ON p.sku_id = s.id 
WHERE 
  EXTRACT(MONTH FROM p.created_at) IN (9, 10) 
  AND s.category = 'Телефон' 
  AND u.city = 'Москва'
GROUP BY TO_CHAR(p.created_at, 'Month')
ORDER BY cnt_people DESC
```