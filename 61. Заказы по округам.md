# Заказы по округам

## Дано
Дана следующая структура таблиц:

![Схема базы](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database20.png)

## Задание
Для каждого заказа есть покупатель, а у каждого покупателя есть географическая принадлежность - округ (```county```).

Напишите запрос, чтобы вывести ```county_code```, имя округа и общее количество заказов, созданных каждым округом. Отсортируйте результаты по общему количеству заказов в порядке убывания.

Если несколько округов создали одинаковое количество заказов, отсортируйте результат по ```county_code```.
А также, если несколько округов создали одинаковое количество заказов и их количество меньше максимального числа созданных заказов, исключите эти округа из результата.

## Столбцы в результате
- ```county_code```
- ```name```
- ```orders_created``` (количество созданных заказов)

## Решение
``` SQL
SELECT 
  county_code, 
  name, 
  COUNT(*) AS orders_created 
FROM 
  C_ORDERS 
  JOIN CUSTOMER USING(id_customer) 
  JOIN COUNTY USING(county_code) 
GROUP BY 
  county_code, 
  name 
ORDER BY 
  orders_created DESC, 
  county_code
```