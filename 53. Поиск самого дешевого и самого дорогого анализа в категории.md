# Поиск самого дешевого и самого дорогого анализа в категории

## Дано
Таблица ```assay```:

```
+---------------------------------------------------------+
|   assay                                                 |
+---------------------------------------------------------+
|   id_an - идентификатор анализа (PK)                    |
|   name - название анализа                               |
|   id_type - тип анализа                                 |
|   preanalysis - требуется ли специальная преаналитика   |
|   id_cat_an - идентификатор категории                   |
|   cost_price - закупочная цена                          |
|   selling_price - розничная цена                        |
|   term - температурный режим                            |
|   info - дополнительная информация                      |
+---------------------------------------------------------+
```

## Задание
Напишите запрос, который возвращает следующую информацию:

- идентификатор анализа (поле ```id_an```)
- название анализа (поле ```name```)
- идентификатор категории анализа (поле ```id_cat_an```)
- розничная цена анализа (поле ```selling_price```)
- название анализа, имеющего самую дешевую розничную цену в категории (```id_cat_an```). Столбец назовите ```mn_an_sel_price```.
- название анализа, имеющего самую дорогую розничную цену в категории (```id_cat_an```). Столбец назовите ```mx_an_sel_price```.

**Важно:** обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

**Сортировка:** основной результат запроса отсортируйте по возрастанию ```id_cat_an```, ```id_an```.

## Решение
``` SQL
SELECT 
  id_an, 
  name, 
  id_cat_an, 
  selling_price, 
  FIRST_VALUE(name) over (
    PARTITION BY id_cat_an 
    ORDER BY 
      selling_price
  ) as mx_an_sel_price, 
  FIRST_VALUE(name) over (
    PARTITION BY id_cat_an 
    ORDER BY 
      selling_price DESC
  ) as mn_an_sel_price 
FROM 
  assay a 
ORDER BY 
  id_cat_an, 
  id_an
```