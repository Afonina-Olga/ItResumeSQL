# Изучить самую дорогую и самую дешевую позицию

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database43.png)

## Задание
Для каждого дня найти самую дорогую и самую дешевую позицию в нем и посчитать среднюю стоимость самых дорогих и среднюю стоимость самых дешевых позиций.

**Примечание.** Если за день было продано несколько позиций с одинаковой ценой, то учитывать только одну.

## Столбцы в результате
- ```avg_cheap``` - средняя стоимость самых дешевых позиций
- ```avg_exp``` - средняя стоимость самых дорогих позиций

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Решение
``` SQL
WITH sales AS (
  SELECT 
    MIN(an_price) AS min, 
    MAX(an_price) AS max 
  FROM 
    Orders o 
    JOIN Analysis a ON o.ord_an = a.an_id 
  GROUP BY 
    ord_datetime
) 
SELECT 
  AVG(min) AS avg_cheap, 
  AVG(max) AS avg_exp 
FROM 
  sales

```