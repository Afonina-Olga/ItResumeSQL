# Нарастающий итог продаж

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database1.png "Схема БД")

## Задание
Выведите накопительным итогом сумму розничных продаж анализов.

**Примечание по накопительному итогу:** накопительный итог суммы розничных продаж считайте по дате в хронологическом порядке, а в пределах одной даты по возрастанию номера заказа.

## Столбцы для вывода
- ```dt``` - дата заказа (только дата, без времени)
- ```ord_id``` - идентификатор заказа
- ```an_price``` - розничная цена анализа
- ```cumsum``` - накопительный итог

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат отсортируйте по возрастанию поля ```dt``` и ```ord_id```.

## Решение
``` SQL
SELECT 
  ord_datetime :: DATE dt, 
  ord_id, 
  an_price, 
  SUM(an_price) OVER (
    ORDER BY 
      ord_datetime :: DATE, 
      ord_id
  ) AS cumsum 
FROM 
  orders o 
  LEFT JOIN analysis a ON o.ord_an = a.an_id 
ORDER BY 
  dt, 
  ord_id
```