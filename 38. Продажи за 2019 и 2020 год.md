# Продажи за 2019 и 2020 год

## Дано
Дана следующая структура таблиц:

![структура таблиц](https://github.com/Afonina-Olga/ItResumeSQL/blob/main/img/database1.png "Схема БД")

## Задание
Для каждого анализа вывести: ID анализа, кол-во продаж за 2019 год и кол-во продаж за 2020 год.

## Столбцы в результате
- ```an``` - ID анализа
- ```year2019``` - рассчитанное кол-во продаж за 2019 год
- ```year2020``` - рассчитанное кол-во продаж за 2020 год

**Важно:** Обратите внимание, что название столбцов в вашем ответе должно в точности совпадать с условием.

## Сортировка
Результат отсортируйте по возрастанию ID анализа.

## Решение
``` SQL
SELECT 
  an_id AS an, 
  COUNT(*) FILTER(
    WHERE 
      EXTRACT(
        YEAR 
        FROM 
          ord_datetime
      ) = 2019
  ) AS year2019, 
  COUNT(*) FILTER(
    WHERE 
      EXTRACT(
        YEAR 
        FROM 
          ord_datetime
      ) = 2020
  ) AS year2020 
FROM 
  Analysis a 
  INNER JOIN Orders o ON a.an_id = o.ord_an 
GROUP BY 
  an_id 
ORDER BY 
  an_id
```